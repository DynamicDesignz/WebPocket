from lib.BaseExploit import BaseExploit
from lib.ExploitOption import ExploitOption


class Exploit(BaseExploit):

    def __init__(self):
        super(Exploit, self).__init__()
        self.update_info(info={
            "name": "zabbix 2.0.3 sqli",
            "description": "zabbix 2.0.3 jsrpc.php sqli",
            "author": ["TuuuNya", "unknown"],
            "references": [
                "https://www.hackersb.cn/hacker/219.html",
                "https://www.hackersb.cn/hacker/167.html",
            ],
            "disclosure_date": "2016-08-22",
            "service_name": "zabbix",
            "service_version": "2.0.6",
        })
        self.register_options([
            ExploitOption(
                name="host",
                required=True,
                description="The target url",
                value=None
            ),
        ])

    def exploit(self):
        self.results.success(
            data={
                "target": self.options.get_option("host"),
                "webshell": "123"
            },
            message="Webshell: {}".format("123")
        )
        return self.results
