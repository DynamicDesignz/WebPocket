from lib.ExploitOptions import ExploitOptions


class BaseExploit:
    name = None
    description = None
    author = []
    references = []
    disclosure_date = None
    service_name = None
    service_version = None
    info_fields = ['name', 'description', 'author', 'references', 'disclosure_date', 'service_name', 'service_version']

    options = ExploitOptions()

    def __init__(self):
        pass

    def get_info(self):
        return {
            "name": self.name,
            "description": self.description,
            "author": self.author,
            "references": self.references,
            "service_name": self.service_name,
            "service_version": self.service_version,
        }

    def update_info(self, info):
        for name in info:
            if name in self.info_fields:
                setattr(self, name, info[name])

    def register_options(self, option_array):
        for option in option_array:
            self.options.add_option(option)

    def validate_options(self):
        for option in self.options.get_options():
            option.validate_option()
        return True

    def exploit(self):
        self.validate_options()

